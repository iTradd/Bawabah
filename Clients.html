<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>%/'1) 'D9ED'!</title>
    <style>
        html, body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
            background-color: #FBF8EF;
            direction: rtl;
        }
        header {
            background-color: #F96E2A;
            color: white;
            text-align: center;
            padding: 20px;
            font-size: 24px;
            font-weight: bold;
        }
        
        .navbar {
    display: flex;
    justify-content: center;
    background-color: #78B3CE;
    padding: 10px 0;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    margin-bottom: 20px;
}
.navbar a {
    text-decoration: none;
    padding: 10px 20px;
    margin: 0 10px;
    font-size: 16px;
    font-weight: bold;
    color: white;
    border-radius: 5px;
    transition: background-color 0.3s, color 0.3s;
}

.navbar a:hover {
    background-color: white;
    color: #141414;
}
        h1 {
            text-align: center;
            color: #141414;
            margin-bottom: 20px;
        }

        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .action-buttons button {
            background-color: #F96E2A;
            color: white;
            border: none;
            cursor: pointer;
            font-size: 16px;
            padding: 12px;
            border-radius: 5px;
            transition: background-color 0.3s ease;
        }

        .action-buttons button:hover {
            background-color: #141414;
        }

        .client-list {
            margin-top: 20px;
            border: 1px solid #ccc;
            border-radius: 10px;
            background-color: #fff;
            padding: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        table th, table td {
            text-align: right;
            padding: 10px;
            border: 1px solid #ccc;
        }

        table th {
            background-color: #F96E2A;
            color: white;
        }

        form {
            display: none;
            background-color: #fff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            max-width: 600px;
            margin: auto;
            margin-top: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 5px;
            display: block;
        }

        input, select {
            padding: 10px;
            font-size: 14px;
            border: 1px solid #ccc;
            border-radius: 5px;
            width: 100%;
            box-sizing: border-box;
        }

        .probability-select {
            font-weight: bold;
        }

        /* #DH'F 'D%-*E'DJ) */
        .high {
            background-color: #28a745;
            color: white;
        }

        .medium {
            background-color: #ff851b;
            color: white;
        }

        .low {
            background-color: #ffc107;
            color: #333;
        }

        button.submit-btn {
            background-color: #F96E2A;
            color: white;
            border: none;
            cursor: pointer;
            font-size: 16px;
            padding: 12px;
            border-radius: 5px;
            transition: background-color 0.3s ease;
            width: 100%;
        }

        button.submit-btn:hover {
            background-color: #141414;
        }
    </style>
</head>
<body>
    <header>
        'D9ED'!
    </header>
<div class="navbar">
    <a href="index.html">'D5A-) 'D1&J3J)</a>
    <a href="Property.html">'D9B'1'*</a>
    <a href="Contract.html">'D9BH/</a>
</div>
    <!-- 'D#21'1 'D9DHJ) -->
    <div class="action-buttons">
        <button id="addClientBtn">%6'A) 9EJD ,/J/</button>
    </div>
        <!-- FEH0, %6'A) 9EJD -->
    <form id="clientForm">
        <div class="form-group">
            <label for="clientName">'3E 'D9EJD:</label>
            <input type="text" id="clientName" name="clientName" placeholder="'3E 'D9EJD" required>
        </div>
        <div class="form-group">
            <label for="phoneNumber">1BE 'D,H'D:</label>
            <input type="text" id="phoneNumber" name="phoneNumber" placeholder="1BE 'D,H'D" required>
        </div>
        <div class="form-group">
            <label for="potentialProperty">'D9B'1 'DE-*ED:</label>
            <select id="potentialProperty" name="potentialProperty" required>
                <option value="">'.*1 'D9B'1 'DE-*ED</option>
                <!-- 3J*E *9(&) 'D9B'1'* EF Google Sheets -->
            </select>
        </div>
        <div class="form-group">
            <label for="probability">'D%-*E'DJ):</label>
                <select id="probability" name="probability" class="probability-select" required>
                <option value="" class="">'.*1 'D%-*E'DJ)</option>
                <option value="9'DJ)" class="high">9'DJ)</option>
                <option value="E*H37)" class="medium">E*H37)</option>
                <option value="EF.A6)" class="low">EF.A6)</option>
            </select>
        </div>
        <button type="submit" class="submit-btn">-A8 'D9EJD</button>
    </form>

    <!-- B'&E) 'D9ED'! -->
    <div class="client-list">
        <h2>B'&E) 'D9ED'!</h2>
        <table>
            <thead>
                <tr>
                    <th>'3E 'D9EJD</th>
                    <th>1BE 'D,H'D</th>
                    <th>'D9B'1 'DE-*ED</th>
                    <th>'D%-*E'DJ)</th>
                    <th>'D%,1'!'*</th> <!-- 9EH/ ,/J/ -->

                </tr>
            </thead>
            <tbody id="clientTableBody">
                <!-- 3J*E *9(&) 'D9ED'! /JF'EJCJK' -->
            </tbody>
        </table>
    </div>



    <script>
const scriptURL = 'https://script.google.com/macros/s/AKfycbw2MNBeXvZGvkdwh6DCS9-BhMEkaGZNuqHjihxth_TZaYPH16GtZNjpRiLJoGdEN00/exec';

// 916 'D9ED'!
function fetchClients() {
    fetch(`${scriptURL}?action=getClients&sheet=client`)
    .then(response => response.json())
    .then(data => renderClients(data))
    .catch(error => console.error("Error fetching clients:", error));
}

function renderClients(clients) {
    const clientTableBody = document.getElementById('clientTableBody');
    clientTableBody.innerHTML = ''; // *A1J: 'D,/HD

    if (clients.length === 0) {
        clientTableBody.innerHTML = '<tr><td colspan="5">D' *H,/ (J'F'*</td></tr>';
        return;
    }

    clients.forEach(client => {
        const row = document.createElement('tr');
        row.innerHTML = `
            <td>${client.'3E_'D9EJD || ':J1 E*HA1'}</td>
            <td>${client.1BE_'D,H'D || ':J1 E*HA1'}</td>
            <td>${client.'D9B'1_'DE-*ED || ':J1 E*HA1'}</td>
            <td class="${getProbabilityClass(client.'D'-*E'DJ))}">${client.'D'-*E'DJ) || ':J1 E*HA1'}</td>
            <td>
                <button class="delete-btn" data-client="${client.'3E_'D9EJD}">-0A</button>
            </td>
        `;
        clientTableBody.appendChild(row);
    });

    // %6'A) E3*E9'* 'D#-/'+ D#21'1 'D-0A
    document.querySelectorAll('.delete-btn').forEach(button => {
        button.addEventListener('click', (e) => {
            const clientName = e.target.getAttribute('data-client');
            deleteClient(clientName);
        });
    });
}
    function deleteClient(clientName) {
        if (confirm(`GD *1J/ -0A 'D9EJD "${clientName}"`)) {
            fetch(scriptURL, {
                method: 'POST',
                body: JSON.stringify({
                    action: 'deleteClient',
                    clientName: clientName,
                    sheet: 'client'
                }),
                headers: { 'Content-Type': 'application/json' }
            })
            .then(response => response.json())
            .then(result => {
                if (result.status === 'success') {
                    alert('*E -0A 'D9EJD (F,'-!');
                    fetchClients(); // *-/J+ B'&E) 'D9ED'!
                } else {
                    alert('-/+ .7# #+F'! 'D-0A.');
                }
            })
            .catch(error => console.error('Error deleting client:', error));
        }
    }

function getProbabilityClass(probability) {
    switch (probability) {
        case "9'DJ)": return "high";
        case "E*H37)": return "medium";
        case "EF.A6)": return "low";
        default: return "";
    }
}

// %6'A) 9EJD ,/J/
const clientForm = document.getElementById('clientForm');
clientForm.addEventListener('submit', (e) => {
    e.preventDefault();
    const formData = new FormData(clientForm);
    const data = Object.fromEntries(formData);

    fetch(scriptURL, {
        method: 'POST',
        body: JSON.stringify({ ...data, action: 'addClient', sheet: 'client' }),
        headers: { 'Content-Type': 'application/json' },
    })
        .then(response => response.text())
        .then(result => {
            alert("*E -A8 'D9EJD (F,'-!");
            fetchClients();
            clientForm.reset();
            clientForm.style.display = 'none';
        })
        .catch(error => console.error("Error adding client:", error));
});

// 916 FEH0, %6'A) 'D9EJD 9F/ 'DFB1 9DI 21 "%6'A) 9EJD ,/J/"
const addClientBtn = document.getElementById('addClientBtn'); // 'D*#C/ EF *91JA 'D21
addClientBtn.addEventListener('click', () => {
    clientForm.style.display = 'block'; // 916 'DFEH0,
    clientForm.reset(); // %9'/) *9JJF 'D-BHD
});

// ,D( 'D9B'1'* 'DE-*ED)
function fetchPotentialProperties() {
    const potentialPropertySelect = document.getElementById('potentialProperty');
    fetch(`${scriptURL}?action=getProperties&sheet=Real_Estate`)
        .then(response => response.json())
        .then(properties => {
            potentialPropertySelect.innerHTML = '<option value="">'.*1 'D9B'1 'DE-*ED</option>';
            properties.forEach(property => {
                const option = document.createElement('option');
                option.value = property.'3E_'D9B'1;
                option.textContent = property.'3E_'D9B'1;
                potentialPropertySelect.appendChild(option);
            });
        })
        .catch(error => console.error("Error fetching properties:", error));
}

// *-EJD 'D9ED'! H'D9B'1'* 9F/ A*- 'D5A-)
document.addEventListener('DOMContentLoaded', () => {
    fetchClients();
    fetchPotentialProperties();
});

    </script>
</body>
</html>
